CREATE TABLE IF NOT EXISTS books (id BINARY(16) PRIMARY KEY, title VARCHAR(255) NOT NULL, author VARCHAR(255) NOT NULL, isbn VARCHAR(20) NOT NULL, copies_available INT DEFAULT 1 NOT NULL, created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) NOT NULL);
ALTER TABLE books ADD CONSTRAINT books_isbn_unique UNIQUE (isbn);
CREATE TABLE IF NOT EXISTS loans (id BINARY(16) PRIMARY KEY, user_id BINARY(16) NOT NULL, book_id BINARY(16) NOT NULL, borrowed_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) NOT NULL, returned_at DATETIME(6) NULL, CONSTRAINT fk_loans_user_id__id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE RESTRICT ON UPDATE RESTRICT, CONSTRAINT fk_loans_book_id__id FOREIGN KEY (book_id) REFERENCES books(id) ON DELETE RESTRICT ON UPDATE RESTRICT);